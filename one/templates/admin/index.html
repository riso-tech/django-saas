{% extends "admin/base_site.html" %}
{% load i18n static grp_tags log %}

{% if not is_popup %}
  {% block breadcrumbs %}
    {% if title %}
      <!--begin::Item-->
      <li class="breadcrumb-item">
        <i class="ki-duotone ki-right fs-4 text-gray-700 mx-n1"></i></li>
      <!--end::Item-->
      <!--begin::Item-->
      <li class="breadcrumb-item text-gray-500">
        {{ title }}
      </li>
      <!--end::Item-->
    {% endif %}
  {% endblock breadcrumbs %}
{% endif %}

{% block content_title %}
  {% if title %}{{ title }}{% endif %}
{% endblock content_title %}

{% block admin_title %}
  <h1 id="grp-admin-title">
    {% trans "Django administration" as vanilla_site_header %}
    {% if site_header and site_header != vanilla_site_header %}
      {{ site_header|safe }}
    {% elif grappelli_admin_title %}
      {{ grappelli_admin_title }}
    {% else %}
      {% get_admin_title %}
    {% endif %}
  </h1>
{% endblock admin_title %}

{% block content %}
  <!--begin::Row-->
  <div class="row g-5 g-xl-10">
    <!--begin::Col-->
    <div class="col-xl-4">
      {% for app in app_list %}
        <!--begin::{{ app.name|upper }}-->
        <div class="card card-flush {% if not forloop.first %}mt-5{% endif %}" id="app_{{ app.name|lower }}">
          <!--begin::Header-->
          <div class="card-header min-h-50px">
            <!--begin::Title-->
            <h3 class="card-title align-items-start flex-column m-0 h-50px">
              <span class="card-label fw-bold text-gray-800 {% if False %}grp-module{% endif %}">
                <a href="{{ app.app_url }}"
                   class="text-gray-500 text-hover-primary {% if False %}grp-section{% endif %}">
                  {% trans app.name %}
                </a>
              </span>
            </h3>
            <!--end::Title-->
          </div>
          <!--end::Header-->

          <!--begin::Body-->
          <div class="card-body pt-0 pb-0">
            <!--begin::Table container-->
            <div class="table-responsive">
              <!--begin::Table-->
              <table class="table table-row-dashed align-middle gs-0 gy-4 my-0">
                <!--begin::Table body-->
                <tbody>
                {% for model in app.models %}
                  <tr class="grp-row" id="model-{{ model.object_name|lower }}">
                    <td>
                      {% if model.admin_url %}
                        <a href="{{ model.admin_url }}" class="text-gray-800 fw-bold text-hover-primary mb-1 fs-6">
                          {{ model.name }}
                        </a>
                      {% else %}
                        <span class="text-gray-400 fw-semibold d-block fs-7">{{ model.name }}</span>
                      {% endif %}
                    </td>
                    <td class="text-end">
                      {% if model.add_url %}
                        <a class="btn btn-sm btn-icon btn-bg-light btn-active-color-primary w-25px h-25px"
                           href="{{ model.add_url }}">
                          <i class="ki-duotone ki-plus fs-2 text-gray-500"></i>
                        </a>
                      {% endif %}
                    </td>
                  </tr>
                {% endfor %}
                </tbody>
                <!--end::Table body-->
              </table>
              <!--end::Table-->
            </div>
            <!--end::Table container-->
          </div>
          <!--end::Body-->

        </div>
        <!--end::{{ app.name|upper }}-->

      {% empty %}
        <p>{% trans "You donÂ´t have permission to edit anything." %}</p>
      {% endfor %}
    </div>
    <!--end::Col-->

    <!--begin::Col-->
    <div class="col-xl-4">
      {% block custom_views %}
        {% if custom_list %}
          <div class="grp-module" id="custom_views">
            <h2>{% trans 'Custom Views' %}</h2>
            {% for path, name in custom_list %}
              <div class="grp-row">
                <a href="{{ path }}"><strong>{{ name }}</strong></a>
              </div>
            {% endfor %}
          </div>
        {% endif %}
      {% endblock custom_views %}
    </div>
    <!--end::Col-->

    <!--begin::Col-->
    <div class="col-xl-4">
      <!--begin::List widget 23-->
      <div class="card card-flush">
        <!--begin::Header-->
        <div class="card-header pt-7">
          <!--begin::Title-->
          <h3 class="card-title align-items-start flex-column">
            <span class="card-label fw-bold text-gray-800">{% trans 'Recent actions' %}</span>
            <span class="text-gray-400 mt-1 fw-semibold fs-6">{% trans 'My actions' %}</span>
          </h3>
          <!--end::Title-->
        </div>
        <!--end::Header-->
        <!--begin::Body-->
        <div class="card-body pt-5">
          <!--begin::Items-->
          <div class="">
            {% get_admin_log 10 as admin_log for_user user %}
            {% if not admin_log %}
              {% trans 'Not available' %}
            {% else %}
              {% for entry in admin_log %}
                <!--begin::Item-->
                <div class="d-flex flex-stack">
                  <!--begin::Section-->
                  <div class="d-flex align-items-center me-5">
                    <!--begin::Content-->
                    <div class="me-5">
                      {% if entry.is_addition %}
                        <span class="text-success py-3 fw-semibold fw-6">{% trans 'Add' %}</span>
                      {% endif %}
                      {% if entry.is_change %}
                        <span class="text-primary py-3 fw-semibold fw-6">{% trans 'Change' %}</span>
                      {% endif %}
                      {% if entry.is_deletion %}
                        <span class="text-warning py-3 fw-semibold fw-6">{% trans 'Delete' %}</span>
                        <span>{% filter capfirst %}{% trans entry.content_type.name %}{% endfilter %}</span>
                        {{ entry.object_repr }}
                      {% else %}
                        <span>
                          {% filter capfirst %}{% trans entry.content_type.name %}{% endfilter %}
                        </span>
                        <a href="{{ entry.get_admin_url }}" class="text-gray-800 fw-bold text-hover-primary fs-6">
                          {{ entry.object_repr }}
                        </a>
                      {% endif %}
                    </div>
                    <!--end::Content-->
                  </div>
                  <!--end::Section-->
                </div>
                <!--end::Item-->
                <!--begin::Separator-->
                <div class="separator separator-dashed my-3"></div>
                <!--end::Separator-->
              {% endfor %}
            {% endif %}
          </div>
          <!--end::Items-->
        </div>
        <!--end: Card Body-->
      </div>
      <!--end::List widget 23-->
    </div>
    <!--end::Col-->
  </div>
  <!--end::Row-->
{% endblock %}
